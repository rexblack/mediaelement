/*
 * Media Element
 * HTML5 <video> libary
 * http://mediaelementjs.com/
 *
 * Creates a JavaScript object that mimics HTML5 media objects
 * through a Flash->JavaScript|Silverlight bridge
 *
 * Copyright 2010, John Dyer
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Version: 1.0.2
 */
(function(){if(typeof window.console=="undefined"){window.console={log:function(){}}}var o=["audio","video","source"];for(var v=0;v<o.length;v++){document.createElement(o[v])}var j={},f=0,p={silverlight:[{version:"3.0",type:"video/mp4"},{version:"3.0",type:"video/m4v"},{version:"3.0",type:"video/mov"},{version:"3.0",type:"video/wmv"},{version:"3.0",type:"audio/wma"},{version:"3.0",type:"audio/mp4"},{version:"3.0",type:"audio/m4a"},{version:"3.0",type:"audio/mp3"}],flash:[{version:"9.0.124",type:"video/mp4"},{version:"9.0.124",type:"video/flv"},{version:"9.0.124",type:"video/mov"},{version:"9.0.124",type:"audio/mp3"},{version:"9.0.124",type:"audio/m4a"},{version:"9.0.124",type:"audio/mp4"},{version:"9.0.124",type:"audio/flv"}]};var s="undefined",k="object",a="Shockwave Flash",y="ShockwaveFlash.ShockwaveFlash",l="application/x-shockwave-flash",g="SWFObjectExprInst",b="onreadystatechange",e=window,x=document,h=navigator,w=function(){var i=typeof x.getElementById!=s&&typeof x.getElementsByTagName!=s&&typeof x.createElement!=s,A=h.userAgent.toLowerCase(),C=h.platform.toLowerCase(),E=[0,0,0],D=null;if(typeof h.plugins!=s&&typeof h.plugins[a]==k){D=h.plugins[a].description;if(D&&!(typeof h.mimeTypes!=s&&h.mimeTypes[l]&&!h.mimeTypes[l].enabledPlugin)){plugin=true;ie=false;D=D.replace(/^.*\s+(\S+\s+\S+$)/,"$1");E[0]=parseInt(D.replace(/^(.*)\..*$/,"$1"),10);E[1]=parseInt(D.replace(/^.*\.(.*)\s.*$/,"$1"),10);E[2]=/[a-zA-Z]/.test(D)?parseInt(D.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof e.ActiveXObject!=s){try{var z=new ActiveXObject(y);if(z){D=z.GetVariable("$version");if(D){ie=true;D=D.split(" ")[1].split(",");E=[parseInt(D[0],10),parseInt(D[1],10),parseInt(D[2],10)]}}}catch(B){}}}return{pv:E}}();function d(A){var z=w.pv,i=A.split(".");i[0]=parseInt(i[0],10);i[1]=parseInt(i[1],10)||0;i[2]=parseInt(i[2],10)||0;return(z[0]>i[0]||(z[0]==i[0]&&z[1]>i[1])||(z[0]==i[0]&&z[1]==i[1]&&z[2]>=i[2]))?true:false}var c={};c.isInstalled=function(K){if(K==undefined){K=null}var L=false,z=null;try{var D=null,C=false;if(window.ActiveXObject){try{D=new ActiveXObject("AgControl.AgControl");if(K===null){L=true}else{if(D.IsVersionSupported(K)){L=true}}D=null}catch(A){C=true}}else{C=true}if(C){var B=navigator.plugins["Silverlight Plug-In"];if(B){if(K===null){L=true}else{var E=B.description;if(E==="1.0.30226.2"){E="2.0.30226.2"}var J=E.split(".");while(J.length>3){J.pop()}while(J.length<4){J.push(0)}var H=K.split(".");while(H.length>4){H.pop()}var I,F,G=0;do{I=parseInt(H[G]);F=parseInt(J[G]);G++}while(G<H.length&&I===F);if(I<=F&&!isNaN(I)){L=true}}}}}catch(A){L=false}return L};function q(i,z){switch(i){case"flash":return d(z);case"silverlight":return c.isInstalled(z);default:return false}}function r(i){return i.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")}function n(i){var z=document.createElement("div");z.innerHTML='<a href="'+r(i)+'">x</a>';return z.firstChild.href}function u(C){var B="";var z=document.getElementsByTagName("script");for(var A=0;A<z.length;A++){if(z[A].src.indexOf(C)>-1){B=z[A].src.substring(0,z[A].src.indexOf(C))}}return B}var m=u("mediaelement.js");var t={enablePluginDebug:false,plugins:["silverlight","flash"],type:"",flashUrl:m+"flashmediaelement.swf",silverlightUrl:m+"silverlightmediaelement.xap",defaultVideoWidth:480,defaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,success:function(){},error:function(){}};j.MediaElement=function(A,W){var F=A;if(typeof A=="string"){F=document.getElementById(A)}var ae=(F.tagName.toLowerCase()=="video");var D=t;for(var C in W){D[C]=W[C]}var O=(typeof(F.canPlayType)!="undefined");var ac=false;var ad="";var G="";var J="";function B(i,aj){if(navigator.userAgent.indexOf("Android")>-1&&(i=="video/mp4"||i=="video/m4v"||i=="video/mov")){ac=true;return}if(aj&&!i){var al=aj.substring(aj.lastIndexOf(".")+1);i=((ae)?"video":"audio")+"/"+al}if(O&&F.canPlayType(i).replace(/no/,"")!=""){ac=true}else{for(pi=0;pi<D.plugins.length;pi++){var ai=D.plugins[pi];var ah=p[ai];for(var ak=0;ak<ah.length;ak++){if(i==ah[ak].type&&q(ai,ah[ak].version)){ad=aj;G=ai}}}}}if(typeof(D.type)!="undefined"&&D.type!=""){B(D.type,null)}else{if(F.getAttribute("src")!="undefined"&&F.getAttribute("src")!=null){var K=F.getAttribute("src");var E=F.getAttribute("type");B(E,K);J=K}else{for(var aa=0;aa<F.childNodes.length;aa++){var A=F.childNodes[aa];if(A.nodeType==1&&A.tagName.toLowerCase()=="source"){var E=A.getAttribute("type");var K=A.getAttribute("src");B(E,K);if(J==""){J=K}}}}}if(!O&&navigator.userAgent.indexOf("Safari")>-1){F.innerHTML="You need to install Quicktime for Safari to operate properly. Weird, huh?";D.error(F);return}if(ac){for(var Z in j.HtmlMediaElement){F[Z]=j.HtmlMediaElement[Z]}var I=false;var R=(F.getAttribute("autoplay")!=null);if(R){function H(){if(!I){F.play()}}var L="progress timeupdate".split(" ");function z(){for(var ah in L){F.addEventListener(L[ah],H,false)}}function S(){for(var ah in L){F.removeEventListener(L[ah],H,false)}}z();F.addEventListener("playing",function(){I=true;S()},true)}D.success(F,F);return F}else{if(G!=""){var X=1;var V=1;var ag="me_"+G+"_"+(f++);var M=(ad!=null)?n(ad):"";var af=(F.getAttribute("poster")==null)?F.getAttribute("poster"):"";var R=(F.getAttribute("autoplay")!=null);if(ae){X=(D.videoWidth>0)?D.videoWidth:(F.getAttribute("width")!==null)?F.getAttribute("width"):D.defaultVideoWidth;V=(D.videoHeight>0)?D.videoHeight:(F.getAttribute("height")!==null)?F.getAttribute("height"):D.defaultVideoHeight}else{if(D.enablePluginDebug){X=320;V=240}}var Y=j.PluginMediaElement(ag,G);Y.success=D.success;j.MediaPluginBridge.registerPluginElement(ag,Y,F);var Q=document.createElement("div");F.parentNode.insertBefore(Q,F);var U=["id="+ag,"poster="+af,"autoplay="+R,"width="+X,"height="+V];if(M!=null){U.push("file="+M)}if(D.enablePluginDebug){U.push("debug=true")}var N="";switch(G){case"silverlight":Q.innerHTML='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2"id="'+ag+'" width="'+X+'" height="'+V+'"><param name="initParams" value="'+U.join(",")+'" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="4.0.50401.0" /><param name="autoUpgrade" value="true" /><param name="source" value="'+D.silverlightUrl+'" /></object>';break;case"flash":if(navigator.appName.indexOf("Microsoft")!=-1){Q.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab"id="'+ag+'" width="'+X+'" height="'+V+'"> <param name="movie" value="'+D.flashUrl+"?x="+(new Date())+'" /> <param name="flashvars" value="'+U.join("&")+'" /> <param name="quality" value="high" /> <param name="bgcolor" value="#000000" /> <param name="wmode" value="transparent" /> <param name="allowScriptAccess" value="sameDomain" /> <param name="allowFullScreen" value="true" /> </object>'}else{Q.innerHTML='<embed name="'+ag+'" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="sameDomain" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+D.flashUrl+"?"+U.join("&")+'" width="'+X+'" height="'+V+'"></embed>'}break}F.style.display="none";return Y}else{var T=document.createElement("div");T.className="me-cannotplay";try{T.style.width=F.width+"px";T.style.height=F.height+"px"}catch(ab){}var P=F.getAttribute("poster");if(P=="undefined"||P==""||P==null){T.innerHTML='<a href="'+J+'">Download file</a>'}else{T.innerHTML='<a href="'+J+'"><img src="'+F.getAttribute("poster")+'" /></a>'}F.parentNode.insertBefore(T,F);F.style.display="none";D.error(F)}}};j.HtmlMediaElement={pluginType:"native",setCurrentTime:function(i){this.currentTime=i},setMuted:function(i){this.muted=i},setVolume:function(i){this.volume=i},setSrc:function(i){this.src=i},setVideoSize:function(z,i){this.width=z;this.height=i}};j.PluginMediaElement=function(i,A){var z={};return{id:i,pluginType:A,pluginElement:null,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:true,ended:false,seeking:false,duration:0,muted:false,volume:1,currentTime:0,play:function(){this.pluginApi.playMedia();this.paused=false},load:function(){this.pluginApi.loadMedia();this.paused=false},pause:function(){this.pluginApi.pauseMedia();this.paused=true},setSrc:function(B){this.pluginApi.setSrc(n(B))},setCurrentTime:function(B){this.pluginApi.setCurrentTime(B);this.currentTime=B},setVolume:function(B){this.pluginApi.setVolume(B);this.volume=B},setMuted:function(B){this.pluginApi.setMuted(B);this.muted=B},setVideoSize:function(C,B){if(this.pluginElement.style){this.pluginElement.style.width=C+"px";this.pluginElement.style.height=B+"px"}this.pluginApi.setVideoSize(C,B)},setFullscreen:function(B){this.pluginApi.setFullscreen(B)},addEventListener:function(C,D,B){z[C]=z[C]||[];z[C].push(D)},dispatchEvent:function(B){var D,E=z[B],C;if(E){C=Array.prototype.slice.call(arguments,1);for(D=0;D<E.length;D++){E[D].apply(null,C)}}}}};j.MediaPluginBridge=(function(){var i=[];var z=[];return{registerPluginElement:function(C,B,A){i[C]=B;z[C]=A},initPlugin:function(C){var B=i[C];var A=z[C];switch(B.pluginType){case"flash":if(navigator.appName.indexOf("Microsoft")!=-1){B.pluginElement=B.pluginApi=window[C]}else{B.pluginElement=B.pluginApi=document[C]}break;case"silverlight":B.pluginElement=document.getElementById(B.id);B.pluginApi=B.pluginElement.Content.SilverlightApp;break}if(B.success){B.success(B,A)}},fireEvent:function(G,C,B){var E=i[G];E.ended=false;E.paused=false;var F={type:C,target:E};for(var D in B){E[D]=B[D];F[D]=B[D]}var A=B.bufferedTime||0;F.target.buffered=F.buffered={start:function(H){return 0},end:function(H){return A},length:1};E.dispatchEvent(F.type,F)}}}());window.html5=j;window.MediaElement=j.MediaElement})();