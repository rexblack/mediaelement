/*!
* MediaElement.js
* HTML5 <video> and <audio> shim and player
* http://mediaelementjs.com/
*
* Creates a JavaScript object that mimics HTML5 MediaElement API
* for browsers that don't understand HTML5 or can't play the provided codec
* Can play MP4 (H.264), Ogg, WebM, FLV, WMV, WMA, ACC, and MP3
*
* Copyright 2010-2011, John Dyer (http://j.hn)
* Dual licensed under the MIT or GPL Version 2 licenses.
*
*/var mejs=mejs||{};mejs.version="2.2.5";mejs.meIndex=0;mejs.plugins={silverlight:[{version:[3,0],types:["video/mp4","video/m4v","video/mov","video/wmv","audio/wma","audio/m4a","audio/mp3","audio/wav","audio/mpeg"]}],flash:[{version:[9,0,124],types:["video/mp4","video/m4v","video/mov","video/flv","video/x-flv","audio/flv","audio/x-flv","audio/mp3","audio/m4a","audio/mpeg"]}]};
mejs.Utility={encodeUrl:function(b){return encodeURIComponent(b)},escapeHTML:function(b){return b.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},absolutizeUrl:function(b){var c=document.createElement("div");c.innerHTML='<a href="'+this.escapeHTML(b)+'">x</a>';return c.firstChild.href},getScriptPath:function(b){for(var c=0,d,e="",f="",h,g=document.getElementsByTagName("script");c<g.length;c++){h=g[c].src;for(d=0;d<b.length;d++){f=b[d];if(h.indexOf(f)>-1){e=h.substring(0,
h.indexOf(f));break}}if(e!=="")break}return e},secondsToTimeCode:function(b,c,d,e){if(typeof d=="undefined")d=false;else if(typeof e=="undefined")e=25;var f=Math.floor(b/3600)%24,h=Math.floor(b/60)%60,g=Math.floor(b%60);b=Math.floor((b%1*e).toFixed(3));return(c||f>0?(f<10?"0"+f:f)+":":"")+(h<10?"0"+h:h)+":"+(g<10?"0"+g:g)+(d?":"+(b<10?"0"+b:b):"")},timeCodeToSeconds:function(b,c,d,e){if(typeof d=="undefined")d=false;else if(typeof e=="undefined")e=25;b=b.split(":");c=parseInt(b[0]);var f=parseInt(b[1]),
h=parseInt(b[2]),g=0,k=0;if(d)g=parseInt(b[3])/e;return k=c*3600+f*60+h+g}};
mejs.PluginDetector={hasPluginVersion:function(b,c){var d=this.plugins[b];c[1]=c[1]||0;c[2]=c[2]||0;return d[0]>c[0]||d[0]==c[0]&&d[1]>c[1]||d[0]==c[0]&&d[1]==c[1]&&d[2]>=c[2]?true:false},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(b,c,d,e,f){this.plugins[b]=this.detectPlugin(c,d,e,f)},detectPlugin:function(b,c,d,e){var f=[0,0,0],h;if(typeof this.nav.plugins!="undefined"&&typeof this.nav.plugins[b]=="object"){if((d=this.nav.plugins[b].description)&&
!(typeof this.nav.mimeTypes!="undefined"&&this.nav.mimeTypes[c]&&!this.nav.mimeTypes[c].enabledPlugin)){f=d.replace(b,"").replace(/^\s+/,"").replace(/\sr/gi,".").split(".");for(b=0;b<f.length;b++)f[b]=parseInt(f[b].match(/\d+/),10)}}else if(typeof window.ActiveXObject!="undefined")try{if(h=new ActiveXObject(d))f=e(h)}catch(g){}return f}};
mejs.PluginDetector.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(b){var c=[];if(b=b.GetVariable("$version")){b=b.split(" ")[1].split(",");c=[parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10)]}return c});
mejs.PluginDetector.addPlugin("silverlight","Silverlight Plug-In","application/x-silverlight-2","AgControl.AgControl",function(b){var c=[0,0,0,0],d=function(e,f,h,g){for(;e.isVersionSupported(f[0]+"."+f[1]+"."+f[2]+"."+f[3]);)f[h]+=g;f[h]-=g};d(b,c,0,1);d(b,c,1,1);d(b,c,2,1E4);d(b,c,2,1E3);d(b,c,2,100);d(b,c,2,10);d(b,c,2,1);d(b,c,3,1);return c});
mejs.MediaFeatures={init:function(){var b=this,c=document,d=mejs.PluginDetector.nav,e=mejs.PluginDetector.ua.toLowerCase(),f,h=["source","track","audio","video"];b.isiPad=e.match(/ipad/i)!==null;b.isiPhone=e.match(/iphone/i)!==null;b.isiOS=b.isiPhone||b.isiPad;b.isAndroid=e.match(/android/i)!==null;b.isBustedAndroid=e.match(/android 2\.[12]/)!==null;b.isIE=d.appName.toLowerCase().indexOf("microsoft")!=-1;b.isChrome=e.match(/chrome/gi)!==null;b.isFirefox=e.match(/firefox/gi)!==null;b.isGecko=e.match(/gecko/gi)!==
null;b.isWebkit=e.match(/webkit/gi)!==null;for(d=0;d<h.length;d++)f=document.createElement(h[d]);b.supportsMediaTag=typeof f.canPlayType!=="undefined"||b.isBustedAndroid;b.hasSemiNativeFullScreen=typeof f.webkitEnterFullscreen!=="undefined";b.hasWebkitNativeFullScreen=typeof f.webkitRequestFullScreen!=="undefined";b.hasMozNativeFullScreen=typeof f.mozRequestFullScreen!=="undefined";b.hasTrueNativeFullScreen=b.hasWebkitNativeFullScreen||b.hasMozNativeFullScreen;if(this.isChrome)b.hasSemiNativeFullScreen=
false;if(b.hasTrueNativeFullScreen){b.fullScreenEventName=b.hasWebkitNativeFullScreen?"webkitfullscreenchange":"mozfullscreenchange";b.isFullScreen=function(){if(f.mozRequestFullScreen)return c.mozFullScreen;else if(f.webkitRequestFullScreen)return c.webkitIsFullScreen};b.requestFullScreen=function(g){if(b.hasWebkitNativeFullScreen)g.webkitRequestFullScreen();else b.hasMozNativeFullScreen&&g.mozRequestFullScreen()};b.cancelFullScreen=function(){if(b.hasWebkitNativeFullScreen)document.webkitCancelFullScreen();
else b.hasMozNativeFullScreen&&document.mozCancelFullScreen()}}if(b.hasSemiNativeFullScreen&&e.match(/mac os x 10_5/i)){b.hasNativeFullScreen=false;b.hasSemiNativeFullScreen=false}}};mejs.MediaFeatures.init();
mejs.HtmlMediaElement={pluginType:"native",isFullScreen:false,setCurrentTime:function(b){this.currentTime=b},setMuted:function(b){this.muted=b},setVolume:function(b){this.volume=b},stop:function(){this.pause()},setSrc:function(b){for(var c=this.getElementsByTagName("source");c.length>0;)this.removeChild(c[0]);if(typeof b=="string")this.src=b;else{var d;for(c=0;c<b.length;c++){d=b[c];if(this.canPlayType(d.type))this.src=d.src}}},setVideoSize:function(b,c){this.width=b;this.height=c}};
mejs.PluginMediaElement=function(b,c,d){this.id=b;this.pluginType=c;this.src=d;this.events={}};
mejs.PluginMediaElement.prototype={pluginElement:null,pluginType:"",isFullScreen:false,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:true,ended:false,seeking:false,duration:0,error:null,muted:false,volume:1,currentTime:0,play:function(){if(this.pluginApi!=null){this.pluginApi.playMedia();this.paused=false}},load:function(){if(this.pluginApi!=null){this.pluginApi.loadMedia();this.paused=false}},pause:function(){if(this.pluginApi!=null){this.pluginApi.pauseMedia();this.paused=
true}},stop:function(){if(this.pluginApi!=null){this.pluginApi.stopMedia();this.paused=true}},canPlayType:function(b){var c,d,e,f=mejs.plugins[this.pluginType];for(c=0;c<f.length;c++){e=f[c];if(mejs.PluginDetector.hasPluginVersion(this.pluginType,e.version))for(d=0;d<e.types.length;d++)if(b==e.types[d])return true}return false},setSrc:function(b){if(typeof b=="string"){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(b));this.src=mejs.Utility.absolutizeUrl(b)}else{var c,d;for(c=0;c<b.length;c++){d=
b[c];if(this.canPlayType(d.type)){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(d.src));this.src=mejs.Utility.absolutizeUrl(b)}}}},setCurrentTime:function(b){if(this.pluginApi!=null){this.pluginApi.setCurrentTime(b);this.currentTime=b}},setVolume:function(b){if(this.pluginApi!=null){this.pluginApi.setVolume(b);this.volume=b}},setMuted:function(b){if(this.pluginApi!=null){this.pluginApi.setMuted(b);this.muted=b}},setVideoSize:function(b,c){if(this.pluginElement.style){this.pluginElement.style.width=
b+"px";this.pluginElement.style.height=c+"px"}this.pluginApi!=null&&this.pluginApi.setVideoSize(b,c)},setFullscreen:function(b){this.pluginApi!=null&&this.pluginApi.setFullscreen(b)},enterFullScreen:function(){this.setFullscreen(true)},enterFullScreen:function(){this.setFullscreen(false)},addEventListener:function(b,c){this.events[b]=this.events[b]||[];this.events[b].push(c)},removeEventListener:function(b,c){if(!b){this.events={};return true}var d=this.events[b];if(!d)return true;if(!c){this.events[b]=
[];return true}for(i=0;i<d.length;i++)if(d[i]===c){this.events[b].splice(i,1);return true}return false},dispatchEvent:function(b){var c,d,e=this.events[b];if(e){d=Array.prototype.slice.call(arguments,1);for(c=0;c<e.length;c++)e[c].apply(null,d)}}};
mejs.MediaPluginBridge={pluginMediaElements:{},htmlMediaElements:{},registerPluginElement:function(b,c,d){this.pluginMediaElements[b]=c;this.htmlMediaElements[b]=d},initPlugin:function(b){var c=this.pluginMediaElements[b],d=this.htmlMediaElements[b];switch(c.pluginType){case "flash":c.pluginElement=c.pluginApi=document.getElementById(b);break;case "silverlight":c.pluginElement=document.getElementById(c.id);c.pluginApi=c.pluginElement.Content.MediaElementJS}c.pluginApi!=null&&c.success&&c.success(c,
d)},fireEvent:function(b,c,d){var e,f;b=this.pluginMediaElements[b];b.ended=false;b.paused=true;c={type:c,target:b};for(e in d){b[e]=d[e];c[e]=d[e]}f=d.bufferedTime||0;c.target.buffered=c.buffered={start:function(){return 0},end:function(){return f},length:1};b.dispatchEvent(c.type,c)}};
mejs.MediaElementDefaults={mode:"auto",plugins:["flash","silverlight"],enablePluginDebug:false,type:"",pluginPath:mejs.Utility.getScriptPath(["mediaelement.js","mediaelement.min.js","mediaelement-and-player.js","mediaelement-and-player.min.js"]),flashName:"flashmediaelement.swf",enablePluginSmoothing:false,silverlightName:"silverlightmediaelement.xap",defaultVideoWidth:480,defaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,timerRate:250,startVolume:0.8,success:function(){},error:function(){}};
mejs.MediaElement=function(b,c){return mejs.HtmlMediaElementShim.create(b,c)};
mejs.HtmlMediaElementShim={create:function(b,c){var d=mejs.MediaElementDefaults,e=typeof b=="string"?document.getElementById(b):b,f=e.tagName.toLowerCase(),h=f==="audio"||f==="video",g=h?e.getAttribute("src"):e.getAttribute("href");f=e.getAttribute("poster");var k=e.getAttribute("autoplay"),j=e.getAttribute("preload"),m=e.getAttribute("controls"),l;for(l in c)d[l]=c[l];g=g=="undefined"||g==""||g===null?null:g;f=typeof f=="undefined"||f===null?"":f;j=typeof j=="undefined"||j===null||j==="false"?"none":
j;k=!(typeof k=="undefined"||k===null||k==="false");m=!(typeof m=="undefined"||m===null||m==="false");l=this.determinePlayback(e,d,mejs.MediaFeatures.supportsMediaTag,h,g);l.url=l.url!==null?mejs.Utility.absolutizeUrl(l.url):"";if(l.method=="native"){if(mejs.MediaFeatures.isBustedAndroid){e.src=l.url;e.addEventListener("click",function(){e.play()},true)}return this.updateNative(l,d,k,j)}else if(l.method!=="")return this.createPlugin(l,d,f,k,j,m);else this.createErrorMessage(l,d,f)},determinePlayback:function(b,
c,d,e,f){var h=[],g,k,j={method:"",url:"",htmlMediaElement:b,isVideo:b.tagName.toLowerCase()!="audio"},m,l;if(typeof c.type!="undefined"&&c.type!=="")if(typeof c.type=="string")h.push({type:c.type,url:f});else for(g=0;g<c.type.length;g++)h.push({type:c.type[g],url:f});else if(f!==null){k=this.formatType(f,b.getAttribute("type"));h.push({type:k,url:f})}else for(g=0;g<b.childNodes.length;g++){k=b.childNodes[g];if(k.nodeType==1&&k.tagName.toLowerCase()=="source"){f=k.getAttribute("src");k=this.formatType(f,
k.getAttribute("type"));h.push({type:k,url:f})}}if(!e&&h.length>0&&h[0].url!==null&&this.getTypeFromFile(h[0].url).indexOf("audio")>-1)j.isVideo=false;if(mejs.MediaFeatures.isBustedAndroid)b.canPlayType=function(n){return n.match(/video\/(mp4|m4v)/gi)!==null?"maybe":""};if(d&&(c.mode==="auto"||c.mode==="native")){if(!e){g=document.createElement(j.isVideo?"video":"audio");b.parentNode.insertBefore(g,b);b.style.display="none";j.htmlMediaElement=b=g}for(g=0;g<h.length;g++)if(b.canPlayType(h[g].type).replace(/no/,
"")!==""||b.canPlayType(h[g].type.replace(/mp3/,"mpeg")).replace(/no/,"")!==""){j.method="native";j.url=h[g].url;break}if(j.method==="native"){if(j.url!==null)b.src=j.url;return j}}if(c.mode==="auto"||c.mode==="shim")for(g=0;g<h.length;g++){k=h[g].type;for(b=0;b<c.plugins.length;b++){f=c.plugins[b];m=mejs.plugins[f];for(d=0;d<m.length;d++){l=m[d];if(mejs.PluginDetector.hasPluginVersion(f,l.version))for(e=0;e<l.types.length;e++)if(k==l.types[e]){j.method=f;j.url=h[g].url;return j}}}}if(j.method===
"")j.url=h[0].url;return j},formatType:function(b,c){return b&&!c?this.getTypeFromFile(b):c&&~c.indexOf(";")?c.substr(0,c.indexOf(";")):c},getTypeFromFile:function(b){b=b.substring(b.lastIndexOf(".")+1);return(/(mp4|m4v|ogg|ogv|webm|flv|wmv|mpeg|mov)/gi.test(a)?"video":"audio")+"/"+b},createErrorMessage:function(b,c,d){var e=b.htmlMediaElement,f=document.createElement("div");f.className="me-cannotplay";try{f.style.width=e.width+"px";f.style.height=e.height+"px"}catch(h){}f.innerHTML=d!==""?'<a href="'+
b.url+'"><img src="'+d+'" /></a>':'<a href="'+b.url+'"><span>Download File</span></a>';e.parentNode.insertBefore(f,e);e.style.display="none";c.error(e)},createPlugin:function(b,c,d,e,f,h){d=b.htmlMediaElement;var g=1,k=1,j="me_"+b.method+"_"+mejs.meIndex++,m=new mejs.PluginMediaElement(j,b.method,b.url),l=document.createElement("div"),n;for(n=d.parentNode;n!==null&&n.tagName.toLowerCase()!="body";){if(n.parentNode.tagName.toLowerCase()=="p"){n.parentNode.parentNode.insertBefore(n,n.parentNode);break}n=
n.parentNode}if(b.isVideo){g=c.videoWidth>0?c.videoWidth:d.getAttribute("width")!==null?d.getAttribute("width"):c.defaultVideoWidth;k=c.videoHeight>0?c.videoHeight:d.getAttribute("height")!==null?d.getAttribute("height"):c.defaultVideoHeight;g=mejs.Utility.encodeUrl(g);k=mejs.Utility.encodeUrl(k)}else if(c.enablePluginDebug){g=320;k=240}m.success=c.success;mejs.MediaPluginBridge.registerPluginElement(j,m,d);l.className="me-plugin";d.parentNode.insertBefore(l,d);e=["id="+j,"isvideo="+(b.isVideo?"true":
"false"),"autoplay="+(e?"true":"false"),"preload="+f,"width="+g,"startvolume="+c.startVolume,"timerrate="+c.timerRate,"height="+k];if(b.url!==null)b.method=="flash"?e.push("file="+mejs.Utility.encodeUrl(b.url)):e.push("file="+b.url);c.enablePluginDebug&&e.push("debug=true");c.enablePluginSmoothing&&e.push("smoothing=true");h&&e.push("controls=true");switch(b.method){case "silverlight":l.innerHTML='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="'+j+'" name="'+
j+'" width="'+g+'" height="'+k+'"><param name="initParams" value="'+e.join(",")+'" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="'+c.pluginPath+c.silverlightName+'" /></object>';break;case "flash":if(mejs.MediaFeatures.isIE){b=document.createElement("div");l.appendChild(b);b.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+
j+'" width="'+g+'" height="'+k+'"><param name="movie" value="'+c.pluginPath+c.flashName+"?x="+new Date+'" /><param name="flashvars" value="'+e.join("&amp;")+'" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'}else l.innerHTML='<embed id="'+j+'" name="'+j+'" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="always" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+
c.pluginPath+c.flashName+'" flashvars="'+e.join("&")+'" width="'+g+'" height="'+k+'"></embed>'}d.style.display="none";return m},updateNative:function(b,c){var d=b.htmlMediaElement,e;for(e in mejs.HtmlMediaElement)d[e]=mejs.HtmlMediaElement[e];c.success(d,d);return d}};window.mejs=mejs;window.MediaElement=mejs.MediaElement;
